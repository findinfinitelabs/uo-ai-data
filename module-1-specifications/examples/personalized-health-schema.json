{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/personalized-health-schema.json",
  "title": "Personalized Health Insights Data Schema",
  "description": "Schema for validating wearable and EHR data for personalized health insights use case",
  "type": "object",
  "properties": {
    "oura_ring_data": {
      "type": "array",
      "description": "Daily health metrics from Oura Ring API v2",
      "items": {
        "type": "object",
        "required": ["user_id", "date"],
        "properties": {
          "user_id": {
            "type": "string",
            "description": "Unique user identifier (PII - Restricted)",
            "pattern": "^usr_[a-z0-9]+$"
          },
          "date": {
            "type": "string",
            "format": "date",
            "description": "Date of recorded metrics (Private)"
          },
          "sleep_score": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Overall sleep quality score (PHI - Confidential)"
          },
          "hrv_avg": {
            "type": "integer",
            "minimum": 10,
            "maximum": 150,
            "description": "Average heart rate variability in milliseconds (PHI - Confidential)"
          },
          "resting_hr": {
            "type": "integer",
            "minimum": 35,
            "maximum": 100,
            "description": "Resting heart rate in bpm (PHI - Confidential)"
          },
          "deep_sleep_mins": {
            "type": "integer",
            "minimum": 0,
            "maximum": 300,
            "description": "Deep sleep duration in minutes (PHI - Confidential)"
          },
          "rem_sleep_mins": {
            "type": "integer",
            "minimum": 0,
            "maximum": 200,
            "description": "REM sleep duration in minutes (PHI - Confidential)"
          },
          "readiness_score": {
            "type": "integer",
            "minimum": 0,
            "maximum": 100,
            "description": "Daily readiness score (PHI - Confidential)"
          }
        }
      }
    },
    "apple_healthkit_data": {
      "type": "array",
      "description": "Health metrics from Apple HealthKit export",
      "items": {
        "type": "object",
        "required": ["record_id", "user_id", "timestamp"],
        "properties": {
          "record_id": {
            "type": "string",
            "description": "Unique record identifier (PII - Restricted)"
          },
          "user_id": {
            "type": "string",
            "description": "Unique user identifier (PII - Restricted)"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp of measurement (Private)"
          },
          "heart_rate": {
            "type": "integer",
            "minimum": 30,
            "maximum": 250,
            "description": "Heart rate in bpm (PHI - Confidential)"
          },
          "steps": {
            "type": "integer",
            "minimum": 0,
            "description": "Step count (Public)"
          },
          "active_calories": {
            "type": "integer",
            "minimum": 0,
            "description": "Active calories burned (Public)"
          },
          "blood_oxygen": {
            "type": "number",
            "minimum": 0.70,
            "maximum": 1.00,
            "description": "Blood oxygen saturation as decimal (PHI - Confidential)"
          },
          "workout_type": {
            "type": "string",
            "enum": ["Running", "Walking", "Cycling", "Swimming", "Strength", "Yoga", "HIIT", "Other"],
            "description": "Type of workout activity (Public)"
          }
        }
      }
    },
    "ehr_data": {
      "type": "array",
      "description": "Electronic Health Records from clinical system",
      "items": {
        "type": "object",
        "required": ["patient_id", "visit_date"],
        "properties": {
          "patient_id": {
            "type": "string",
            "pattern": "^P[0-9]{8}$",
            "description": "Anonymized patient identifier (PHI + PII - Restricted)"
          },
          "visit_date": {
            "type": "string",
            "format": "date",
            "description": "Date of clinical visit (PHI - Private)"
          },
          "provider": {
            "type": "string",
            "description": "Healthcare provider name (Public)"
          },
          "diagnosis_code": {
            "type": "string",
            "pattern": "^[A-Z][0-9]{2}(\\.[0-9]{1,4})?$",
            "description": "ICD-10 diagnosis code (PHI - Confidential)"
          },
          "blood_pressure": {
            "type": "string",
            "pattern": "^[0-9]{2,3}/[0-9]{2,3}$",
            "description": "Blood pressure as systolic/diastolic (PHI - Confidential)"
          },
          "glucose_mg_dl": {
            "type": "integer",
            "minimum": 20,
            "maximum": 600,
            "description": "Blood glucose in mg/dL (PHI - Confidential)"
          },
          "a1c_percent": {
            "type": "number",
            "minimum": 3.0,
            "maximum": 15.0,
            "description": "Hemoglobin A1c percentage (PHI - Confidential)"
          },
          "medications": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": { "type": "string" },
                "dosage": { "type": "string" },
                "frequency": { "type": "string" }
              }
            },
            "description": "Current medications list (PHI - Restricted)"
          }
        }
      }
    }
  },
  "examples": [
    {
      "oura_ring_data": [
        {
          "user_id": "usr_a1b2c3d4",
          "date": "2026-01-12",
          "sleep_score": 85,
          "hrv_avg": 42,
          "resting_hr": 58,
          "deep_sleep_mins": 90,
          "rem_sleep_mins": 105,
          "readiness_score": 78
        }
      ],
      "apple_healthkit_data": [
        {
          "record_id": "rec_xyz789",
          "user_id": "usr_a1b2c3d4",
          "timestamp": "2026-01-12T08:30:00Z",
          "heart_rate": 72,
          "steps": 8547,
          "active_calories": 420,
          "blood_oxygen": 0.98,
          "workout_type": "Walking"
        }
      ],
      "ehr_data": [
        {
          "patient_id": "P00001234",
          "visit_date": "2026-01-10",
          "provider": "Dr. Johnson",
          "diagnosis_code": "E11.9",
          "blood_pressure": "138/88",
          "glucose_mg_dl": 115,
          "a1c_percent": 6.2,
          "medications": [
            { "name": "Metformin", "dosage": "500mg", "frequency": "twice daily" },
            { "name": "Lisinopril", "dosage": "10mg", "frequency": "daily" }
          ]
        }
      ]
    }
  ]
}
